pivot_wider(names_from = Artefact, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(CLASSIFICATION) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt(footnote: "Test")
source_note = "Total: 599 (excludes one shouldered point)."
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_source_note(
source_note = "Total: 599 (excludes one shouldered point).")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = sum(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = sum(ARTEFACT)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
mutate(Total = sum(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = count(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
summarise(Total = count(n)) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = funs(sum)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
summary(data$CONTEXT)
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
summary(data$CLASSIFICATION)
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
library(rio)
library(rio)
library(tidyverse)
library(gt)
function (file, format, setclass, which, ...)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"ORIENTATION",
"BURINATION")
data[cols] <- lapply(data[cols], factor)
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
blade_data <- filter(data, ARTEFACT == "Blade")
core_data <- filter(data, ARTEFACT == "Core")
bp_data <- filter(data, ARTEFACT == "Backed Point")
tp_data <- filter(data, ARTEFACT == "Tanged Point")
library(FactoMineR)
library(factoextra)
View(blade_data)
blade_test <- blade_data %>% select(CLASSIFICATION, WEIGHT, LENGTH, WIDTH, THICKNESS, PLAT_DEPTH)
PCA(blade_test, quali.sup = 1)
test <- PCA(blade_test, quali.sup = 1)
fviz_pca_contrib(test)
fviz_pca_biplot(test)
pca_rec <- recipe(~., data = blade_test) %>%
update_role(CLASSIFICATION, new_role = "id") %>%
step_normalize(all_predictors()) %>%
step_pca(all_predictors())
pca_prep <- prep(pca_rec)
pca_prep
tidied_pca <- tidy(pca_prep, 2)
library(tidymodels)
pca_rec <- recipe(~., data = blade_test) %>%
update_role(CLASSIFICATION, new_role = "id") %>%
step_normalize(all_predictors()) %>%
step_pca(all_predictors())
pca_prep <- prep(pca_rec)
pca_prep
tidied_pca <- tidy(pca_prep, 2)
base <- tidied_pca %>%
filter(component %in% paste0("PC", 1:5)) %>%
mutate(component = fct_inorder(component)) %>%
ggplot(aes(value, terms, fill = terms))
base
base + geom_col()
base + geom_col() + facet_wrap(~component)
top <- juice(pca_prep) %>%
ggplot(aes(PC1, PC2, label = CLASSIFICATION))
top
top + geom_point()
top <- juice(pca_prep) %>%
ggplot(aes(PC1, PC2, colour = CLASSIFICATION))
top + geom_point()
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
library(rio)
library(rio)
library(tidyverse)
library(gt)
library(FactoMineR)
library(factoextra)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
View(data)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
View(data)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
library(rio)
library(rio)
library(tidyverse)
library(gt)
library(FactoMineR)
library(gt)
library(FactoMineR)
library(factoextra)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"ORIENTATION",
"BURINATION")
data[cols] <- lapply(data[cols], factor)
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"BURINATION")
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-TidyTuesday")
library(tidyverse)
library(ggrepel)
library(extrafont)
library(gganimate)
library(here)
kids <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv')
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme(legend.position = "none",
axis.text.y = element_blank(),
axis.title.y = element_blank()) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme(legend.position = "none",
axis.text.y = element_blank(),
axis.title.y = element_blank()) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education \n Top 15 states in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal()
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal() +
theme(legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
axis.text.y = element_blank(),
axis.title.y = element_blank()) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education \n Top 15 States in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal() +
theme(plot.title = element_text(size = 14, family = "Caliso MT", margin = margin(0,0,40,0)),
legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
plot.caption = element_text(size = 9, family = "IBM Plex Sans", margin = margin(40, 0, 0, 0))) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education \n Top 15 States in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal() +
theme(legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
plot.title = element_text(size = 14, family = "Caliso MT", margin = margin(0,0,40,0)),
plot.caption = element_text(size = 9, family = "IBM Plex Sans", margin = margin(40, 0, 0, 0)),
axis.text.y = element_blank(),
axis.title.y = element_blank())
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal() +
theme(legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
plot.title = element_text(size = 14, family = "Caliso MT", margin = margin(0,0,40,0)),
plot.caption = element_text(size = 9, family = "IBM Plex Sans", margin = margin(40, 0, 0, 0)),
axis.text.y = element_blank(),
axis.title.y = element_blank()) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education \n Top 15 States in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
warnings()
library(extrafont)
kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15) %>%
ggplot(aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 0.05, label = paste(state, " ")), vjust = 0, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = inf_adj_perchild, hjust= -0.1)) +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5) +
theme_minimal() +
theme(legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
plot.title = element_text(size = 14, family = "Caliso MT", margin = margin(0,0,40,0)),
plot.caption = element_text(size = 9, family = "IBM Plex Sans", margin = margin(40, 0, 0, 0)),
axis.text.y = element_blank(),
axis.title.y = element_blank()) +
transition_states(year) +
labs(y = "Spending per individual (per $1000)",
title = "US Public Spending on Higher Education \n Top 15 States in... {closest_state}",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
warnings()
