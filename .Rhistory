data %>%
group_by(ARTEFACT) %>%
count(CONTEXT)
data_count <- data %>%
group_by(ARTEFACT) %>%
count(CONTEXT)
View(data_count)
View(data_count)
data_count %>% pivot_wider(names_from = ARTEFACT, values_from = CONTEXT)
data_count %>% pivot_wider(names_from = CONTEXT, values_from = ARTEFACT)
data_count %>% pivot_wider(names_from = CONTEXT, values_from = ARTEFACT, values_fn = list)
data_count %>% pivot_wider(names_from = CONTEXT, values_from = n)
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n)
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
fct_reorder() %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
fct_reorder(CONTEXT) %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
gt(rowname_col = ARTEFACT, groupname_col = CONTEXT)
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
gt(rowname_col = ARTEFACT)
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = CONTEXT, values_from = n) %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
summary(data$CONDITION)
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt(caption = "test")
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt(label = "test")
data %>%
group_by(ARTEFACT) %>%
count(CLASSIFICATION) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
capabilities()
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
select(Context = CONTEXT) %>%
gt()
group_by(Context) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
select(Context = "CONTEXT")
data %>%
group_by(Context) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
group_by(CONTEXT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
group_by(CONTEXT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data[cols] <- lapply(data[cols], factor)
data %>%
group_by(CONTEXT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
group_by(ARTEFACT) %>%
count(CONTEXT) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
group_by(Artefact) %>%
count(CONTEXT) %>%
pivot_wider(names_from = Artefact, values_from = n) %>%
gt()
data %>%
rename(Artefact = ARTEFACT) %>%
group_by(Artefact) %>%
count(CONTEXT) %>%
pivot_wider(names_from = Artefact, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
count(Context) %>%
pivot_wider(names_from = Artefact, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(CLASSIFICATION) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt()
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt(footnote: "Test")
source_note = "Total: 599 (excludes one shouldered point)."
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_source_note(
source_note = "Total: 599 (excludes one shouldered point).")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = sum(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = sum(ARTEFACT)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
mutate(Total = sum(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = count(n)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
summarise(Total = count(n)) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
summarise(Total = funs(sum)) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
summary(data$CONTEXT)
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
summary(data$CLASSIFICATION)
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
library(rio)
library(rio)
library(tidyverse)
library(gt)
function (file, format, setclass, which, ...)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"ORIENTATION",
"BURINATION")
data[cols] <- lapply(data[cols], factor)
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
filter(!ARTEFACT %in% "Shouldered Point") %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
blade_data <- filter(data, ARTEFACT == "Blade")
core_data <- filter(data, ARTEFACT == "Core")
bp_data <- filter(data, ARTEFACT == "Backed Point")
tp_data <- filter(data, ARTEFACT == "Tanged Point")
library(FactoMineR)
library(factoextra)
View(blade_data)
blade_test <- blade_data %>% select(CLASSIFICATION, WEIGHT, LENGTH, WIDTH, THICKNESS, PLAT_DEPTH)
PCA(blade_test, quali.sup = 1)
test <- PCA(blade_test, quali.sup = 1)
fviz_pca_contrib(test)
fviz_pca_biplot(test)
pca_rec <- recipe(~., data = blade_test) %>%
update_role(CLASSIFICATION, new_role = "id") %>%
step_normalize(all_predictors()) %>%
step_pca(all_predictors())
pca_prep <- prep(pca_rec)
pca_prep
tidied_pca <- tidy(pca_prep, 2)
library(tidymodels)
pca_rec <- recipe(~., data = blade_test) %>%
update_role(CLASSIFICATION, new_role = "id") %>%
step_normalize(all_predictors()) %>%
step_pca(all_predictors())
pca_prep <- prep(pca_rec)
pca_prep
tidied_pca <- tidy(pca_prep, 2)
base <- tidied_pca %>%
filter(component %in% paste0("PC", 1:5)) %>%
mutate(component = fct_inorder(component)) %>%
ggplot(aes(value, terms, fill = terms))
base
base + geom_col()
base + geom_col() + facet_wrap(~component)
top <- juice(pca_prep) %>%
ggplot(aes(PC1, PC2, label = CLASSIFICATION))
top
top + geom_point()
top <- juice(pca_prep) %>%
ggplot(aes(PC1, PC2, colour = CLASSIFICATION))
top + geom_point()
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
library(rio)
library(rio)
library(tidyverse)
library(gt)
library(FactoMineR)
library(factoextra)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/database.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
View(data)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
View(data)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
library(rio)
library(rio)
library(tidyverse)
library(gt)
library(FactoMineR)
library(gt)
library(FactoMineR)
library(factoextra)
data <- import("https://raw.githubusercontent.com/CSHoggard/-tech-data/master/Hoggard_and_Riede_2020.csv", na.strings=c(""), setclass = "tbl_df", encoding = "UTF-8")
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"ORIENTATION",
"BURINATION")
data[cols] <- lapply(data[cols], factor)
cols <- c("CODE",
"CONTEXT",
"COUNTRY",
"CONDITION",
"ARTEFACT",
"SUB_CATEGORY",
"RECOVERY_METHOD",
"CLASSIFICATION",
"BP_ASSOCIATION",
"TP_ASSOCIATION",
"ABS_DATE_METHOD",
"RELAT_DATE_METHOD",
"RELAT_DATE_CHRONO",
"RAW_MAT",
"DORS_BLADE_PROF",
"BLADE_DET",
"BLADE_CURV",
"DORSAL_PATTERN",
"BULB_MORPH",
"CONUS_FORM",
"BUTT_MORPH",
"BUTT_PREP_1",
"BUTT_PREP_2",
"CORE_MORPH",
"PLAT_REJUV",
"CORE_METHOD",
"CORE_DIRECTIONALITY",
"CORE_TABLET_REJUV",
"CORE_FLAKE_REJUV",
"CORE_FRONT_REJUV",
"CORE_DIST_REJUV",
"CORE_SIDE_REJUV",
"BURINATION")
data %>%
rename(Classification = CLASSIFICATION) %>%
group_by(ARTEFACT) %>%
count(Classification) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 2. Artefact vs. Classification (n = 599)")
data %>%
rename(Context = CONTEXT) %>%
group_by(ARTEFACT) %>%
count(Context) %>%
pivot_wider(names_from = ARTEFACT, values_from = n) %>%
gt() %>%
tab_header(title = "Table 1. Artefact vs. Context (n = 599)")
library(tidyverse)
library(ggrepel)
library(extrafont)
library(gganimate)
library(here)
library(scales)
kids <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv')
kids.clean <- kids %>% filter(variable %in% "highered") %>%
mutate(inf_adj_perchild = round(inf_adj_perchild, 3)) %>%
mutate(inf_adj_perchild = inf_adj_perchild * 1000) %>%
group_by(year) %>%
arrange(year, -inf_adj_perchild) %>%
mutate(rank = 1:n()) %>%
filter(rank <= 15)
p <- ggplot(kids.clean, aes(rank, inf_adj_perchild, fill = state, alpha = 0.5)) +
geom_col(alpha = 0.8) +
geom_text(aes(y = 100, label = paste(state, " "), family = "IBM Plex Sans"), vjust = 0.25, hjust = 0) +
geom_text(aes(y=inf_adj_perchild, label = as.character(dollar(inf_adj_perchild)), family = "IBM Plex Sans"), hjust= -0.1) +
geom_text(x = -14.75 , y = 4250, aes(label = as.character(year), family = "IBM Plex Sans"), size = 16, col = "grey18") +
coord_flip(clip = "off", expand = TRUE) +
scale_x_reverse() +
ylim(0,5000) +
theme_minimal() +
theme(legend.position = "none",
plot.margin = margin(30, 30, 30, 30),
plot.title = element_text(size = 20, family = "IBM Plex Sans", face = "bold", margin = margin(20,0,5,0)),
plot.subtitle = element_text(size = 14, family = "IBM Plex Sans", margin = margin(0,0,15,0)),
plot.caption = element_text(size = 10, family = "IBM Plex Sans", margin = margin(20, 0, 0, 0)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 12, family = "IBM Plex Sans")) +
transition_states(year) +
labs(y = "Spending per individual",
title = "US Public Spending on Higher Education",
subtitle = "Top 15 States in...",
caption = "Source: State and Local Government Finance Survey (United States Census Bureau) \n Courtesy of the Urban Institute and the tidykids R package \n @CSHoggard | #TidyTuesday Week 38")
animate(p, nframes = 130, width = 450, height = 600)
anim_save("images/Week_38_Kids.gif", animation = last_animation())
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-TidyTuesday")
detach("package:here", unload = TRUE)
library(here)
anim_save("images/Week_38_Kids.gif", animation = last_animation())
animate(p, nframes = 150, width = 450, height = 600)
animate(p, nframes = 140, width = 450, height = 600)
animate(p, nframes = 190, width = 450, height = 600)
animate(p, nframes = 190, fps = 15, width = 450, height = 600)
animate(p, nframes = 190, fps = 12, width = 450, height = 600)
anim_save("images/Week_38_Kids.gif", animation = last_animation())
