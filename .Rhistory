"Estonia",
"Finland",
"Germany",
"Hungary",
"Iceland",
"Ireland",
"Italy",
"Lithuania",
"Netherlands",
"Norway",
"Poland",
"Portugal",
"Russia",
"Slovenia",
"Spain",
"Sweden",
"Switzerland",
"United Kingdom")) %>%
group_by(entity) %>%
mutate(
first = first(net_forest_conversion),
last = last(net_forest_conversion),
change = (last - first),
gl = if_else(change > 0, "Positive", "Negative")) %>%
select(-code, -year, -net_forest_conversion, -first, -last) %>%
filter(!change == 0) %>%
distinct() %>%
mutate(entity = fct_reorder(toupper(entity), change)) %>%
mutate(
entity = case_when(
entity %in% "NORWAY" ~ glue("<b style='color:#3A571F;'>{entity}</b>"),
entity %in% "UNITED KINGDOM" ~ glue("<b style='color:#3A571F;'>{entity}</b>"),
entity %in% "BULGARIA" ~ glue("<b style='color:#3A571F;'>{entity}</b>"),
TRUE ~ glue("<b style='color:#70ACAB;'>{entity}</b>")
))
ggplot(forest_clean, aes(reorder(entity, change), -change, fill = gl)) +
geom_col() +
coord_flip() +
labs(y = "Absolute Change in Forest Cover (Hectares)",
caption = "@CSHoggard • #TidyTuesday • Data: Our World In Data") +
scale_fill_manual(values = peacock_palette) +
scale_y_continuous(labels = comma) +
geom_richtext(
aes(x = 13, y = 300000,
label = "<b style='font-size:18pt;'>Which European countries are <span style='color:#70ACAB;'>losing</span> their forests?</br><br><br><span style='font-size:12pt;'><span style='color:#70ACAB;'>Most of them.</span><br><br>Only <span style='color:#3A571F;'>Norway</span>, <span style='color:#3A571F;'>Bulgaria</span> and the <span style='color:#3A571F;'>United Kingdom</span> have seen increases in forest cover since 1990.</br>"),
inherit.aes = FALSE,
color = "grey60",
family = "Roboto",
size = 6,
label.padding = unit(2, "lines"),
label.r = unit(0, "lines"),
label.size = 2,
label.color = "grey60"
)
library(morris)
ggplot(forest_clean, aes(reorder(entity, change), -change, fill = gl)) +
geom_col() +
coord_flip() +
labs(y = "Absolute Change in Forest Cover (Hectares)",
caption = "@CSHoggard • #TidyTuesday • Data: Our World In Data") +
scale_fill_manual(values = peacock_palette) +
scale_y_continuous(labels = comma) +
geom_richtext(
aes(x = 13, y = 300000,
label = "<b style='font-size:18pt;'>Which European countries are <span style='color:#70ACAB;'>losing</span> their forests?</br><br><br><span style='font-size:12pt;'><span style='color:#70ACAB;'>Most of them.</span><br><br>Only <span style='color:#3A571F;'>Norway</span>, <span style='color:#3A571F;'>Bulgaria</span> and the <span style='color:#3A571F;'>United Kingdom</span> have seen increases in forest cover since 1990.</br>"),
inherit.aes = FALSE,
color = "grey60",
family = "Roboto",
size = 6,
label.padding = unit(2, "lines"),
label.r = unit(0, "lines"),
label.size = 2,
label.color = "grey60"
)
img <- load.image("https://github.com/CSHoggard/30DayChartChallenge/blob/main/abstract_image.jpg")
library(imager)
library(tidyverse)
library(ggvoronoi)
library(kableExtra)
library(extrafont)
library(ggtext)
img <- load.image("https://github.com/CSHoggard/30DayChartChallenge/blob/main/abstract_image.jpg")
img <- load.image(url("https://github.com/CSHoggard/30DayChartChallenge/blob/main/abstract_image.jpg"))
img <- load.image("https://github.com/CSHoggard/30DayChartChallenge/raw/main/abstract_image.jpg")
img_df <- as.data.frame(img)
img_df %>%
arrange(x, y, cc) %>%
filter(row_number() < 10) %>%
kable("html") %>%
kable_styling(full_width = F)
img_df <- img_df %>%
mutate(channel = case_when(
cc == 1 ~ "Red",
cc == 2 ~ "Green",
cc == 3 ~ "Blue"
))
img_wide <- img_df %>%
select(x, y, channel, value) %>%
spread(key = channel, value = value) %>%
mutate(
color = rgb(Red, Green, Blue)
)
sample_size <- 10000
img_sample <- img_wide[sample(nrow(img_wide), sample_size), ]
img_sample$size <- runif(sample_size)
ggplot(img_sample) +
geom_point(mapping = aes(x = x, y = y, color = color, size = size)) +
guides(size = FALSE) +
labs(caption = "The Gladstone Pottery Museum (Stoke-on-Trent, UK)<br><br><br><span style='font-size:12pt;'><span style='color:#9DABAC;'>#30DayChartChallenge | @CSHoggard</span></span>") +
scale_color_identity() +
scale_y_reverse() +
theme_void() +
theme(plot.caption = element_markdown(family = "Goudy Old Style", hjust = 0.5, size = 24, margin = margin(20,0,10,0)),
plot.margin = margin(20,20,20,20),
plot.background = element_rect(fill = NA, colour = 'grey40', size = 2))
library(tidyverse)
read_csv("https://www.ons.gov.uk/generator?uri=/peoplepopulationandcommunity/householdcharacteristics/homeinternetandsocialmediausage/articles/exploringtheuksdigitaldivide/2019-03-04/6c8574d8&format=csv")
read_csv("https://www.ons.gov.uk/generator?uri=/peoplepopulationandcommunity/householdcharacteristics/homeinternetandsocialmediausage/articles/exploringtheuksdigitaldivide/2019-03-04/6c8574d8&format=csv", remove = 6)
read_csv("https://www.ons.gov.uk/generator?uri=/peoplepopulationandcommunity/householdcharacteristics/homeinternetandsocialmediausage/articles/exploringtheuksdigitaldivide/2019-03-04/6c8574d8&format=csv", skip = 6)
non_users <- read_csv("https://www.ons.gov.uk/generator?uri=/peoplepopulationandcommunity/householdcharacteristics/homeinternetandsocialmediausage/articles/exploringtheuksdigitaldivide/2019-03-04/6c8574d8&format=csv", skip = 6)
View(non_users)
View(non_users)
non_users_clean <- non_users %>%
pivot_longer(!Region)
View(non_users_clean)
non_users_clean <- non_users %>%
pivot_longer(!Region, names_to = "year", values_to = "percentage")
View(non_users_clean)
View(non_users_clean)
non_users_clean <- non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = year)) +
geom_col()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = year)) +
geom_col()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_bar()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_bar(stat = "identity")
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge")
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_void()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_void() +
theme(legend.position = "none")
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_void() +
theme(legend.position = "none") +
coord_polar()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Region)) +
geom_col(position = "dodge") +
theme_void() +
theme(legend.position = "none") +
coord_polar()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_void() +
theme(legend.position = "none") +
coord_polar()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme(legend.position = "none") +
coord_polar()
non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage") %>%
ggplot(aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_minimal() +
theme(legend.position = "none") +
coord_polar()
non_users_clean %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage")
non_users_clean <- non_users %>%
pivot_longer(!Region, names_to = "Year", values_to = "Percentage")
ggplot(non_users_clean, aes(Region, Percentage, fill = Year)) +
geom_col(position = "dodge") +
theme_minimal() +
theme(legend.position = "none") +
coord_polar()
library(tidyverse)
post_offices <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-13/post_offices.csv')
View(post_offices)
po_clean <- post_offices %>%
filter(coordinates == "TRUE")
View(po_clean)
library(rnaturalearth)
map <- ne_countries(scale = "high", returnclass = "sf", country='United States of America')
map <- ne_countries(scale = "high", returnclass = "sf", country = 'United States of America')
map <- ne_countries(scale = "medium", returnclass = "sf", country = 'United States of America')
ggplot(map) +
geom_sf()
map <- ne_countries(scale = "medium", returnclass = "sf")
ggplot(map) +
geom_sf()
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000,
730000)))
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)))
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000))
library(sf)
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000))
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)) +
geom_point(data = po_clean, aes(longitude, latitude))
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)) +
geom_point(data = po_clean, aes(latitude, longitude), size = 1)
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)) +
geom_point(mapping = po_clean, aes(longitude, latitude), size = 1)
ggplot(map) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)) +
geom_point(data = po_clean, aes(longitude, latitude), size = 1)
po_clean_sf <-  st_as_sf(po_clean, coords = c("longitude", "latitude"))
ggplot(po_clean_sf) +
geom_sf() +
coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 730000)) +
geom_point(data = po_clean, aes(longitude, latitude), size = 1)
ggplot(county, aes(x=long, y=lat, group=group, fill = new)) +
geom_polygon(color = "#E4E4E4") +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(title = "test",
subtitle = "Post Offices Established Following The Second World War",
caption = "test") +
scale_fill_manual(values = c("#EEEEEE", "#4c90c1")) +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.background = element_rect(fill = "#FBFEFF", colour = NA),
legend.position = "none")
library(tidyverse)
ggplot(county, aes(x=long, y=lat, group=group, fill = new)) +
geom_polygon(color = "#E4E4E4") +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(title = "test",
subtitle = "Post Offices Established Following The Second World War",
caption = "test") +
scale_fill_manual(values = c("#EEEEEE", "#4c90c1")) +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.background = element_rect(fill = "#FBFEFF", colour = NA),
legend.position = "none")
county <- map_data("county") %>%
left_join(po_clean, by = c("region"="region","subregion"="subregion")) %>%
mutate(n = replace(n, which(is.na(n)), 0)) %>%
mutate(new = ifelse(n > 0, "Yes", "No"))
post_offices <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-13/post_offices.csv')
po_clean <- post_offices %>%
filter(coordinates == "TRUE") %>%
filter(!state %in% c("AK","HI")) %>%
filter(established > 1945) %>%
filter(is.na(discontinued)) %>%
rename(abb = "state",
subregion = "county1")%>%
group_by(abb, subregion) %>%
tally() %>%
left_join(maps::state.fips, by = "abb") %>%
select(abb, polyname, subregion, n) %>%
mutate(subregion = tolower(subregion)) %>%
rename(region = "polyname") %>%
mutate(region = case_when(
region == "washington:main" ~ "washington",
region == "massachusetts:martha's vineyard" ~ "massachusetts",
region == "massachusetts:main" ~ "massachusetts",
region == "massachusetts:nantucket" ~ "massachusetts",
region == "michigan:north" ~ "michigan",
region == "michigan:south" ~ "michigan",
region == "new york:manhattan" ~ "new york",
region == "new york:main" ~ "new york",
region == "new york:staten island" ~ "new york",
region == "new york:long island" ~ "new york",
region == "north carolina:main" ~ "north carolina",
region == "north carolina:knotts" ~ "north carolina",
region == "north carolina:spit" ~ "north carolina",
region == "virginia:chesapeake" ~ "virginia",
region == "virginia:chincoteague" ~ "virginia",
region == "washington:san juan island" ~ "washington",
region == "washington:lopez island" ~ "washington",
region == "washington:orcas island" ~ "washington",
region == "washington:main" ~ "washington",
TRUE ~ region
))
county <- map_data("county") %>%
left_join(po_clean, by = c("region"="region","subregion"="subregion")) %>%
mutate(n = replace(n, which(is.na(n)), 0)) %>%
mutate(new = ifelse(n > 0, "Yes", "No"))
ggplot(county, aes(x=long, y=lat, group=group, fill = new)) +
geom_polygon(color = "#E4E4E4") +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(title = "test",
subtitle = "Post Offices Established Following The Second World War",
caption = "test") +
scale_fill_manual(values = c("#EEEEEE", "#4c90c1")) +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.background = element_rect(fill = "#FBFEFF", colour = NA),
legend.position = "none")
library(rcartocolor)
library(tidyverse)
library(ggtext)
library(extrafont)
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-TidyTuesday")
library(here)
departures <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-27/departures.csv')
labels <-
departures.clean %>%
filter(id == 135 | id == 2 | id == 253) %>%
mutate(label = glue::glue("<b>{exec_fullname}</b><br><span style='font-size:8pt'>Duration: {duration} years</span>")) %>%
add_column(
x = c(135, 2, 253),
y = c(68, 59, 60)
)
departures.clean <- departures %>%
select(-dismissal_dataset_id, -gvkey, -co_per_rol, -coname, -ceo_dismissal,
-leftofc, -notes, -sources, -eight_ks, -cik) %>%
mutate(duration = fyear_gone - fyear) %>%
mutate(duration2 = duration + 30) %>%
filter(duration > 1) %>%
mutate(departure_code = case_when(
departure_code == 1 ~ "Involuntary (Death)",
departure_code == 2 ~ "Involuntary (Illness)",
departure_code == 3 ~ "Involuntary (Job Performance)",
departure_code == 4 ~ "Involuntary (Concerns or Violations)",
departure_code == 5 ~ "Voluntary (Retirement)",
departure_code == 6 ~ "Voluntary (New Opportunities)",
departure_code == 7 ~ "Other",
departure_code == 8 ~ "Missing",
departure_code == 9 ~ "Error",
TRUE ~ as.character(departure_code)
)) %>%
filter(!departure_code %in% c("Missing", "Error")) %>%
filter(!exec_fullname == "William G. Parzybok, Jr.") %>%
mutate(id = row_number())
ggplot(departures.clean, aes(id, duration2, colour = departure_code)) +
geom_segment(aes(x = id, xend = id, y = 0, yend = duration2), size = 0.6) +
geom_rect(aes(xmin = 1, xmax = 651, ymin = 0, ymax = 30),
fill = "grey99", color = "grey99") +
geom_point(aes(size = duration)) +
labs(caption = "Departure: <span style = 'color:#16A87E;'>Death</span> | <span style = 'color:#3567AB;'>Illness</span> | <span style = 'color:#F2B700;'>Job Performance</span> | <span style = 'color:#7D398C;'>Concerns or Violations</span> | <span style = 'color:#A3A896;'>Retirement</span> | <span style = 'color:#87BF67;'>New Opportunities</span> | <span style = 'color:#E63A70;'>Other</span> <br><br> <b style='font-size:8pt;'><span style = 'color:#BCBCBC;'> Circles represent ten year intervals </span><br><br> @CSHoggard | Data: Gentry et al. (2021)</b>") +
geom_hline(aes(yintercept = (40)), size = 0.4, color = "grey80") +
geom_hline(aes(yintercept = (50)), size = 0.4, color = "grey80") +
geom_richtext(data = labels, aes(x = x, y = y, label = label, color = departure_code),
lineheight = 0.8,
size = 4,
family = "Fira Sans",
fill = NA,
label.color = NA) +
geom_text(x = 325, y = -5,
label = "Why did the CEO leave?",
family = "Fira Sans",
size = 5.5,
lineheight = 0.87,
color = "grey60") +
geom_text(x = 325, y = 0,
label = "(for those who worked at least one year)",
family = "Fira Sans",
size = 3,
lineheight = 0.87,
color = "grey80") +
scale_color_carto_d(palette = "Bold") +
scale_size_continuous(range = c(1, 3)) +
coord_polar() +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.caption = element_textbox_simple(size = 10, halign = 0.5, colour = "grey50", family = "Fira Sans", margin = margin(-30,0,0,0)),
legend.position = "none")
labels <- departures.clean %>%
filter(id == 135 | id == 2 | id == 253) %>%
mutate(label = glue::glue("<b>{exec_fullname}</b><br><span style='font-size:8pt'>Duration: {duration} years</span>")) %>%
add_column(
x = c(135, 2, 253),
y = c(68, 59, 60)
)
ggplot(departures.clean, aes(id, duration2, colour = departure_code)) +
geom_segment(aes(x = id, xend = id, y = 0, yend = duration2), size = 0.6) +
geom_rect(aes(xmin = 1, xmax = 651, ymin = 0, ymax = 30),
fill = "white", color = "white") +
geom_point(aes(size = duration)) +
labs(caption = "Departure: <span style = 'color:#16A87E;'>Death</span> | <span style = 'color:#3567AB;'>Illness</span> | <span style = 'color:#F2B700;'>Job Performance</span> | <span style = 'color:#7D398C;'>Concerns or Violations</span> | <span style = 'color:#A3A896;'>Retirement</span> | <span style = 'color:#87BF67;'>New Opportunities</span> | <span style = 'color:#E63A70;'>Other</span> <br><br> <b style='font-size:8pt;'><span style = 'color:#BCBCBC;'> Circles represent ten year intervals </span><br><br> @CSHoggard | Data: Gentry et al. (2021)</b>") +
geom_hline(aes(yintercept = (40)), size = 0.4, color = "grey80") +
geom_hline(aes(yintercept = (50)), size = 0.4, color = "grey80") +
geom_richtext(data = labels, aes(x = x, y = y, label = label, color = departure_code),
lineheight = 0.8,
size = 4,
family = "Fira Sans",
fill = NA,
label.color = NA) +
geom_text(x = 325, y = -5,
label = "Why did the CEO leave?",
family = "Fira Sans",
size = 5.5,
lineheight = 0.87,
color = "grey60") +
geom_text(x = 325, y = 0,
label = "(for those who worked at least one year)",
family = "Fira Sans",
size = 3,
lineheight = 0.87,
color = "grey80") +
scale_color_carto_d(palette = "Bold") +
scale_size_continuous(range = c(1, 3)) +
coord_polar() +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.caption = element_textbox_simple(size = 10, halign = 0.5, colour = "grey50", family = "Fira Sans", margin = margin(-30,0,0,0)),
legend.position = "none")
ggplot(departures.clean, aes(id, duration2, colour = departure_code)) +
geom_segment(aes(x = id, xend = id, y = 0, yend = duration2), size = 0.3) +
geom_rect(aes(xmin = 1, xmax = 651, ymin = 0, ymax = 30),
fill = "white", color = "white") +
geom_point(aes(size = duration)) +
labs(caption = "Departure: <span style = 'color:#16A87E;'>Death</span> | <span style = 'color:#3567AB;'>Illness</span> | <span style = 'color:#F2B700;'>Job Performance</span> | <span style = 'color:#7D398C;'>Concerns or Violations</span> | <span style = 'color:#A3A896;'>Retirement</span> | <span style = 'color:#87BF67;'>New Opportunities</span> | <span style = 'color:#E63A70;'>Other</span> <br><br> <b style='font-size:8pt;'><span style = 'color:#BCBCBC;'> Circles represent ten year intervals </span><br><br> @CSHoggard | Data: Gentry et al. (2021)</b>") +
geom_hline(aes(yintercept = (40)), size = 0.4, color = "grey80") +
geom_hline(aes(yintercept = (50)), size = 0.4, color = "grey80") +
geom_richtext(data = labels, aes(x = x, y = y, label = label, color = departure_code),
lineheight = 0.8,
size = 4,
family = "Fira Sans",
fill = NA,
label.color = NA) +
geom_text(x = 325, y = -5,
label = "Why did the CEO leave?",
family = "Fira Sans",
size = 5.5,
lineheight = 0.87,
color = "grey60") +
geom_text(x = 325, y = 0,
label = "(for those who worked at least one year)",
family = "Fira Sans",
size = 3,
lineheight = 0.87,
color = "grey80") +
scale_color_carto_d(palette = "Bold") +
scale_size_continuous(range = c(1, 3)) +
coord_polar() +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.caption = element_textbox_simple(size = 10, halign = 0.5, colour = "grey50", family = "Fira Sans", margin = margin(-30,0,0,0)),
legend.position = "none")
ggsave("images/Week_18_CEOs.png", plot = last_plot(), width = 200, height = 210, units = "mm")
ggplot(departures.clean, aes(id, duration2, colour = departure_code)) +
geom_segment(aes(x = id, xend = id, y = 0, yend = duration2), size = 0.3) +
geom_rect(aes(xmin = 1, xmax = 651, ymin = 0, ymax = 30),
fill = "white", color = "white") +
geom_point(aes(size = duration)) +
labs(caption = "Departure: <span style = 'color:#16A87E;'>Death</span> | <span style = 'color:#3567AB;'>Illness</span> | <span style = 'color:#F2B700;'>Job Performance</span> | <span style = 'color:#7D398C;'>Concerns or Violations</span> | <span style = 'color:#A3A896;'>Retirement</span> | <span style = 'color:#87BF67;'>New Opportunities</span> | <span style = 'color:#E63A70;'>Other</span> <br><br> <b style='font-size:8pt;'><span style = 'color:#BCBCBC;'> Circles represent 10-year intervals </span><br><br> @CSHoggard | Data: Gentry et al. (2021)</b>") +
geom_hline(aes(yintercept = (40)), size = 0.4, color = "grey80") +
geom_hline(aes(yintercept = (50)), size = 0.4, color = "grey80") +
geom_richtext(data = labels, aes(x = x, y = y, label = label, color = departure_code),
lineheight = 0.8,
size = 4,
family = "Fira Sans",
fill = NA,
label.color = NA) +
geom_text(x = 325, y = -5,
label = "Why did the CEO leave?",
family = "Fira Sans",
size = 5.5,
lineheight = 0.87,
color = "grey60") +
geom_text(x = 325, y = 0,
label = "(for those who worked at least one year)",
family = "Fira Sans",
size = 3,
lineheight = 0.87,
color = "grey80") +
scale_color_carto_d(palette = "Bold") +
scale_size_continuous(range = c(1, 3)) +
coord_polar() +
theme_void() +
theme(plot.margin = margin(20,20,20,20),
plot.caption = element_textbox_simple(size = 10, halign = 0.5, colour = "grey50", family = "Fira Sans", margin = margin(-30,0,0,0)),
legend.position = "none")
ggsave("images/Week_18_CEOs.png", plot = last_plot(), width = 200, height = 210, units = "mm")
